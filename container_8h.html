<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nmsg: container.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="nmsg.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nmsg<span id="projectnumber">&#160;1.1.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3af54cfecedfb12761767b16ec9023ab.html">nmsg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">container.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for marshalling NMSG containers.  
<a href="#details">More...</a></p>

<p><a href="container_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7a5a2efc1b10b2ce05b1e5d56973495d" id="r_a7a5a2efc1b10b2ce05b1e5d56973495d"><td class="memItemLeft" align="right" valign="top">nmsg_container_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="container_8h.html#a7a5a2efc1b10b2ce05b1e5d56973495d">nmsg_container_init</a> (size_t bufsz)</td></tr>
<tr class="memdesc:a7a5a2efc1b10b2ce05b1e5d56973495d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a new NMSG container object.  <br /></td></tr>
<tr class="separator:a7a5a2efc1b10b2ce05b1e5d56973495d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7da64af1bfb65743a0a83ccda8392d3" id="r_af7da64af1bfb65743a0a83ccda8392d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="container_8h.html#af7da64af1bfb65743a0a83ccda8392d3">nmsg_container_destroy</a> (nmsg_container_t *c)</td></tr>
<tr class="memdesc:af7da64af1bfb65743a0a83ccda8392d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate the resources associated with an nmsg_container_t object.  <br /></td></tr>
<tr class="separator:af7da64af1bfb65743a0a83ccda8392d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab098ec2f5e07cb3ab72034a4e457c4fb" id="r_ab098ec2f5e07cb3ab72034a4e457c4fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="container_8h.html#ab098ec2f5e07cb3ab72034a4e457c4fb">nmsg_container_set_sequence</a> (nmsg_container_t c, bool do_sequence)</td></tr>
<tr class="memdesc:ab098ec2f5e07cb3ab72034a4e457c4fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable or disable NMSG container sequence tracking.  <br /></td></tr>
<tr class="separator:ab098ec2f5e07cb3ab72034a4e457c4fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a28f813d3381be67d0cc7d657221c1e" id="r_a8a28f813d3381be67d0cc7d657221c1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="container_8h.html#a8a28f813d3381be67d0cc7d657221c1e">nmsg_container_add</a> (nmsg_container_t c, nmsg_message_t msg)</td></tr>
<tr class="memdesc:a8a28f813d3381be67d0cc7d657221c1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an NMSG message object to an NMSG container object.  <br /></td></tr>
<tr class="separator:a8a28f813d3381be67d0cc7d657221c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0116f5ade7f62e4f8c7d5278e642962" id="r_ac0116f5ade7f62e4f8c7d5278e642962"><td class="memItemLeft" align="right" valign="top"><a id="ac0116f5ade7f62e4f8c7d5278e642962" name="ac0116f5ade7f62e4f8c7d5278e642962"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>nmsg_container_get_num_payloads</b> (nmsg_container_t c)</td></tr>
<tr class="memdesc:ac0116f5ade7f62e4f8c7d5278e642962"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current number of payloads in the NMSG container object. <br /></td></tr>
<tr class="separator:ac0116f5ade7f62e4f8c7d5278e642962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5829719804bcf2922da7c084e2867ed6" id="r_a5829719804bcf2922da7c084e2867ed6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="container_8h.html#a5829719804bcf2922da7c084e2867ed6">nmsg_container_serialize</a> (nmsg_container_t c, uint8_t **pbuf, size_t *buf_len, bool do_header, bool do_zlib, uint32_t sequence, uint64_t sequence_id)</td></tr>
<tr class="memdesc:a5829719804bcf2922da7c084e2867ed6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize an NMSG container object, allocating memory as needed and returning a free()able buffer containing the serialized data.  <br /></td></tr>
<tr class="separator:a5829719804bcf2922da7c084e2867ed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affe9a54ca55c69758b3b380a76b50edc" id="r_affe9a54ca55c69758b3b380a76b50edc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="container_8h.html#affe9a54ca55c69758b3b380a76b50edc">nmsg_container_deserialize</a> (const uint8_t *buf, size_t buf_len, nmsg_message_t **msgarray, size_t *n_msg)</td></tr>
<tr class="memdesc:affe9a54ca55c69758b3b380a76b50edc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserialize a collection of NMSG messages contained in a buffer containing a serialized NMSG container.  <br /></td></tr>
<tr class="separator:affe9a54ca55c69758b3b380a76b50edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for marshalling NMSG containers. </p>

<p class="definition">Definition in file <a class="el" href="container_8h_source.html">container.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7a5a2efc1b10b2ce05b1e5d56973495d" name="a7a5a2efc1b10b2ce05b1e5d56973495d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a5a2efc1b10b2ce05b1e5d56973495d">&#9670;&#160;</a></span>nmsg_container_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nmsg_container_t nmsg_container_init </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bufsz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a new NMSG container object. </p>
<p>NMSG container objects are used to accumulate NMSG payload objects with <a class="el" href="container_8h.html#a8a28f813d3381be67d0cc7d657221c1e" title="Add an NMSG message object to an NMSG container object.">nmsg_container_add()</a> prior to being marshalled into a buffer containing a serialized NMSG container with <a class="el" href="container_8h.html#a5829719804bcf2922da7c084e2867ed6" title="Serialize an NMSG container object, allocating memory as needed and returning a free()able buffer con...">nmsg_container_serialize()</a>.</p>
<p>After calling <a class="el" href="container_8h.html#a5829719804bcf2922da7c084e2867ed6" title="Serialize an NMSG container object, allocating memory as needed and returning a free()able buffer con...">nmsg_container_serialize()</a> on an NMSG container object, it must be freed by calling <a class="el" href="container_8h.html#af7da64af1bfb65743a0a83ccda8392d3" title="Deallocate the resources associated with an nmsg_container_t object.">nmsg_container_destroy()</a>, as container objects are not reusable.</p>
<dl class="section return"><dt>Returns</dt><dd>Opaque pointer that is NULL on failure or non-NULL on success.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bufsz</td><td>Maximum serialized container length requested by the caller. (This limit cannot be satisfied in all cases, however.) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af7da64af1bfb65743a0a83ccda8392d3" name="af7da64af1bfb65743a0a83ccda8392d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7da64af1bfb65743a0a83ccda8392d3">&#9670;&#160;</a></span>nmsg_container_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nmsg_container_destroy </td>
          <td>(</td>
          <td class="paramtype">nmsg_container_t *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate the resources associated with an nmsg_container_t object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Pointer to an nmsg_container_t object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab098ec2f5e07cb3ab72034a4e457c4fb" name="ab098ec2f5e07cb3ab72034a4e457c4fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab098ec2f5e07cb3ab72034a4e457c4fb">&#9670;&#160;</a></span>nmsg_container_set_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nmsg_container_set_sequence </td>
          <td>(</td>
          <td class="paramtype">nmsg_container_t&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_sequence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable or disable NMSG container sequence tracking. </p>
<p>If called, this function must be called prior to calling to <a class="el" href="container_8h.html#a8a28f813d3381be67d0cc7d657221c1e" title="Add an NMSG message object to an NMSG container object.">nmsg_container_add()</a>. By default, NMSG container sequence tracking is disabled on newly created container objects.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>Pointer to an nmsg_container_t object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8a28f813d3381be67d0cc7d657221c1e" name="a8a28f813d3381be67d0cc7d657221c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a28f813d3381be67d0cc7d657221c1e">&#9670;&#160;</a></span>nmsg_container_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a> nmsg_container_add </td>
          <td>(</td>
          <td class="paramtype">nmsg_container_t&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">nmsg_message_t&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an NMSG message object to an NMSG container object. </p>
<p>Ownership of the message object remains with the caller. The caller is still responsible for calling <a class="el" href="message_8h.html#af3019263d039d43fd4ac780408d9faf9" title="Destroy a message object and deallocate any resources associated with it.">nmsg_message_destroy()</a> on the message object.</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47a686e6e709e9990bb2375b29ee8ac369c" title="success">nmsg_res_success</a></dd>
<dd>
<a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47ae280b6f2004e207b04008b9c61386e51" title="out of memory">nmsg_res_memfail</a></dd>
<dd>
nmsg_res_container_full The message could not be added to the container object because the container object already contains messages and because adding the supplied message would result in a serialized container larger than the maximum serialized container length requested in the corresponding call to <a class="el" href="container_8h.html#a7a5a2efc1b10b2ce05b1e5d56973495d" title="Initialize a new NMSG container object.">nmsg_container_init()</a>.</dd>
<dd>
nmsg_res_container_overfull The message was added to a previously empty container object, but serializing the container would now result in a serialized length larger than the limit requested in the corresponding call to <a class="el" href="container_8h.html#a7a5a2efc1b10b2ce05b1e5d56973495d" title="Initialize a new NMSG container object.">nmsg_container_init()</a>. </dd></dl>

</div>
</div>
<a id="a5829719804bcf2922da7c084e2867ed6" name="a5829719804bcf2922da7c084e2867ed6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5829719804bcf2922da7c084e2867ed6">&#9670;&#160;</a></span>nmsg_container_serialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a> nmsg_container_serialize </td>
          <td>(</td>
          <td class="paramtype">nmsg_container_t&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>pbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_zlib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>sequence_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize an NMSG container object, allocating memory as needed and returning a free()able buffer containing the serialized data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Pointer to an nmsg_container_t object.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pbuf</td><td>Pointer to where a pointer to the serialized buffer will be stored.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf_len</td><td>Pointer to where the length in bytes of the serialized buffer will be stored.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">do_header</td><td>Whether to write the fixed-length NMSG header to the beginning of the buffer.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">do_zlib</td><td>Whether to compress the variable-length part of the serialized NMSG container with zlib.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sequence</td><td>The sequence number of this container. This parameter is only used if <a class="el" href="container_8h.html#ab098ec2f5e07cb3ab72034a4e457c4fb" title="Enable or disable NMSG container sequence tracking.">nmsg_container_set_sequence()</a> was used to enable sequence tracking on this container, and is ignored otherwise. The sequence number should start at 0 and increment by 1 for each additional container in a sequence of containers.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sequence_id</td><td>A randomized ID number identifying the sequence number space that the 'sequence' parameter exists in. This ID number is used by NMSG consumers to disambiguate multiple disparate sequences of NMSG containers when consuming a multiplexed stream from multiple sources. This ID number should be generated by a cryptographically secure PRNG such as the one provided by nmsg_random_init() to minimize the possibility of collisions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="affe9a54ca55c69758b3b380a76b50edc" name="affe9a54ca55c69758b3b380a76b50edc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affe9a54ca55c69758b3b380a76b50edc">&#9670;&#160;</a></span>nmsg_container_deserialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a> nmsg_container_deserialize </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">nmsg_message_t **&#160;</td>
          <td class="paramname"><em>msgarray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deserialize a collection of NMSG messages contained in a buffer containing a serialized NMSG container. </p>
<p>The serialized NMSG container must contain the fixed-length NMSG header followed by the variable-length part of the NMSG container.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Buffer containing the serialized NMSG container.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_len</td><td>Length in bytes of the serialized NMSG container.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">msgarray</td><td>Pointer to where an array of NMSG message objects will be stored. The individual NMSG message objects in this array must be destroyed by the caller with <a class="el" href="message_8h.html#af3019263d039d43fd4ac780408d9faf9" title="Destroy a message object and deallocate any resources associated with it.">nmsg_message_destroy()</a>, and the array itself must be destroyed by the caller with free().</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n_msg</td><td>Pointer to where the number of elements in the NMSG message object array will be stored. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
