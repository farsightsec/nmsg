<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nmsg: ipdg.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="nmsg.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nmsg
   &#160;<span id="projectnumber">0.14.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3af54cfecedfb12761767b16ec9023ab.html">nmsg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ipdg.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>IP datagram parsing functions.  
<a href="#details">More...</a></p>

<p><a href="ipdg_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnmsg__ipdg.html">nmsg_ipdg</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parsed IP datagram.  <a href="structnmsg__ipdg.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab41c9664938edf03b55b9c7753ac42e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ipdg_8h.html#ab41c9664938edf03b55b9c7753ac42e8">nmsg_ipdg_parse</a> (struct <a class="el" href="structnmsg__ipdg.html">nmsg_ipdg</a> *dg, unsigned etype, size_t len, const u_char *pkt)</td></tr>
<tr class="memdesc:ab41c9664938edf03b55b9c7753ac42e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse IP packets from the network layer, discarding fragments.  <a href="#ab41c9664938edf03b55b9c7753ac42e8">More...</a><br /></td></tr>
<tr class="separator:ab41c9664938edf03b55b9c7753ac42e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d9284000e4b81cdb67940c2678f62d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ipdg_8h.html#a3d9284000e4b81cdb67940c2678f62d4">nmsg_ipdg_parse_pcap</a> (struct <a class="el" href="structnmsg__ipdg.html">nmsg_ipdg</a> *dg, nmsg_pcap_t pcap, struct pcap_pkthdr *pkt_hdr, const u_char *pkt)</td></tr>
<tr class="memdesc:a3d9284000e4b81cdb67940c2678f62d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse IP datagrams from the data link layer, performing reassembly if necessary.  <a href="#a3d9284000e4b81cdb67940c2678f62d4">More...</a><br /></td></tr>
<tr class="separator:a3d9284000e4b81cdb67940c2678f62d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8efb156732472d5d983a14fdf6513202"><td class="memItemLeft" align="right" valign="top"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ipdg_8h.html#a8efb156732472d5d983a14fdf6513202">nmsg_ipdg_parse_pcap_raw</a> (struct <a class="el" href="structnmsg__ipdg.html">nmsg_ipdg</a> *dg, int datalink, const uint8_t *pkt, size_t len)</td></tr>
<tr class="memdesc:a8efb156732472d5d983a14fdf6513202"><td class="mdescLeft">&#160;</td><td class="mdescRight">Like <a class="el" href="ipdg_8h.html#a3d9284000e4b81cdb67940c2678f62d4" title="Parse IP datagrams from the data link layer, performing reassembly if necessary. ">nmsg_ipdg_parse_pcap()</a>, but performs no fragment handling.  <a href="#a8efb156732472d5d983a14fdf6513202">More...</a><br /></td></tr>
<tr class="separator:a8efb156732472d5d983a14fdf6513202"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>IP datagram parsing functions. </p>
<p>These functions parse network packets or ethernet frames and return IP datagrams, performing reassembly if requested. Non-IP packets are discarded. </p>

<p class="definition">Definition in file <a class="el" href="ipdg_8h_source.html">ipdg.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab41c9664938edf03b55b9c7753ac42e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab41c9664938edf03b55b9c7753ac42e8">&#9670;&nbsp;</a></span>nmsg_ipdg_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a> nmsg_ipdg_parse </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnmsg__ipdg.html">nmsg_ipdg</a> *&#160;</td>
          <td class="paramname"><em>dg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>etype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>pkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse IP packets from the network layer, discarding fragments. </p>
<p>Populate a struct <a class="el" href="structnmsg__ipdg.html" title="Parsed IP datagram. ">nmsg_ipdg</a> indicating where the network, transport, and payload sections of the packet are and the length of the remaining packet at each of those sections.</p>
<p>This function operates on datagrams from the network layer.</p>
<p>Broken and fragmented datagrams are discarded.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">dg</td><td>caller-allocated struct <a class="el" href="structnmsg__ipdg.html" title="Parsed IP datagram. ">nmsg_ipdg</a> which will be populated after a successful call.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">etype</td><td>ETHERTYPE_* value. The only supported values are ETHERTYPE_IP and ETHERTYPE_IPV6.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length of the packet.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pkt</td><td>pointer to the packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47a686e6e709e9990bb2375b29ee8ac369c" title="success ">nmsg_res_success</a> </dd>
<dd>
<a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47a16aebf391fed25c596de5d1db886f1b3" title="caller should try again ">nmsg_res_again</a> </dd></dl>

</div>
</div>
<a id="a3d9284000e4b81cdb67940c2678f62d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d9284000e4b81cdb67940c2678f62d4">&#9670;&nbsp;</a></span>nmsg_ipdg_parse_pcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a> nmsg_ipdg_parse_pcap </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnmsg__ipdg.html">nmsg_ipdg</a> *&#160;</td>
          <td class="paramname"><em>dg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">nmsg_pcap_t&#160;</td>
          <td class="paramname"><em>pcap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct pcap_pkthdr *&#160;</td>
          <td class="paramname"><em>pkt_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>pkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse IP datagrams from the data link layer, performing reassembly if necessary. </p>
<p>Populate a struct <a class="el" href="structnmsg__ipdg.html" title="Parsed IP datagram. ">nmsg_ipdg</a> indicating where the network, transport, and payload sections of the datagram are and the length of the remaining packet at each of those sections.</p>
<p>This function operates on raw frames returned by libpcap from the data link layer. The packet beginning at 'pkt' must match the datalink type associated with 'pcap' and must be pkt_hdr-&gt;caplen octets long.</p>
<p>libpcap data link types DLT_EN10MB, DLT_RAW, and DLT_LINUX_SLL are supported.</p>
<p>Broken packets are discarded. All but the final fragment of a fragmented datagram are stored internally and <a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47a16aebf391fed25c596de5d1db886f1b3" title="caller should try again ">nmsg_res_again</a> is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">dg</td><td>caller-allocated struct <a class="el" href="structnmsg__ipdg.html" title="Parsed IP datagram. ">nmsg_ipdg</a> which will be populated after a successful call.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pcap</td><td>caller-initialized <a class="el" href="structnmsg__pcap.html">nmsg_pcap</a> object from whose pcap handle the packet 'pkt' was received.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pkt_hdr</td><td>pointer to the pcap packet header corresponding to 'pkt'.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pkt</td><td>pointer to the packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47a686e6e709e9990bb2375b29ee8ac369c" title="success ">nmsg_res_success</a> </dd>
<dd>
<a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47a16aebf391fed25c596de5d1db886f1b3" title="caller should try again ">nmsg_res_again</a> </dd></dl>

</div>
</div>
<a id="a8efb156732472d5d983a14fdf6513202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8efb156732472d5d983a14fdf6513202">&#9670;&nbsp;</a></span>nmsg_ipdg_parse_pcap_raw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="res_8h.html#a521756a76fc3efbb2b8fb2b631b87b47">nmsg_res</a> nmsg_ipdg_parse_pcap_raw </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnmsg__ipdg.html">nmsg_ipdg</a> *&#160;</td>
          <td class="paramname"><em>dg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>datalink</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Like <a class="el" href="ipdg_8h.html#a3d9284000e4b81cdb67940c2678f62d4" title="Parse IP datagrams from the data link layer, performing reassembly if necessary. ">nmsg_ipdg_parse_pcap()</a>, but performs no fragment handling. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">dg</td><td>caller-allocated struct <a class="el" href="structnmsg__ipdg.html" title="Parsed IP datagram. ">nmsg_ipdg</a> which will be populated after a successful call.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">datalink</td><td>libpcap data link type.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pkt</td><td>pointer to the packet.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length of the packet. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
