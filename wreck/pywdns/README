XXX: this documentation is out of date

this module requires cython to build.

run 'Make' to build the python wdns module in the current directory.

functions implemented:

domain_to_str(domain)

    converts a domain name from wire format to presentation format.
    e.g. domain_to_str('\x03www\07example\03com\00') is 'www.example.com.'

def parse_message(msg)

    convert a byte string representing a DNS message into a collection of
    built-in python types.

    currently it returns its result in this format:

        (id, flags,
            (qname, qclass, qtype),
            answer,
            authority,
            additional
        )

    where:

        id          := int (first 16 bit sequence from the DNS header)
        flags       := int (second 16 bit sequence from the DNS header)

        qname       := string (DNS wire-format)
        qtype       := int
        qclass      := int

        answer      := list of rrset's
        authority   := list of rrset's
        additional  := list of rrset's

        rrset       := (rrname, rrclass, rrtype, rrttl, list of rdata's)
        rrname      := string (DNS wire-format)
        rrtype      := int
        rrclass     := int
        rrttl       := int
        rdata       := string (DNS wire-format)


example usage with annotated output:

In [1]: import wdns

In [2]: msg = "\xfb\xbb\x84\x10\x00\x01\x00\x0d\x00\x00\x00\x14\x00\x00\x02\x00\x01\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x14\x01\x4b\x0c\x52\x4f\x4f\x54\x2d\x53\x45\x52\x56\x45\x52\x53\x03\x4e\x45\x54\x00\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x4c\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x4d\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x41\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x42\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x43\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x44\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x45\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x46\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x47\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x48\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x49\xc0\x1e\x00\x00\x02\x00\x01\x00\x07\xe9\x00\x00\x04\x01\x4a\xc0\x1e\xc0\x59\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc6\x29\x00\x04\xc0\x59\x00\x1c\x00\x01\x00\x36\xee\x80\x00\x10\x20\x01\x05\x03\xba\x3e\x00\x00\x00\x00\x00\x00\x00\x02\x00\x30\xc0\x68\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc0\xe4\x4f\xc9\xc0\x77\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc0\x21\x04\x0c\xc0\x86\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\x80\x08\x0a\x5a\xc0\x95\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc0\xcb\xe6\x0a\xc0\xa4\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc0\x05\x05\xf1\xc0\xa4\x00\x1c\x00\x01\x00\x36\xee\x80\x00\x10\x20\x01\x05\x00\x00\x2f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f\xc0\xb3\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc0\x70\x24\x04\xc0\xc2\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\x80\x3f\x02\x35\xc0\xc2\x00\x1c\x00\x01\x00\x36\xee\x80\x00\x10\x20\x01\x05\x00\x00\x01\x00\x00\x00\x00\x00\x00\x80\x3f\x02\x35\xc0\xd1\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc0\x24\x94\x11\xc0\xe0\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc0\x3a\x80\x1e\xc0\xe0\x00\x1c\x00\x01\x00\x36\xee\x80\x00\x10\x20\x01\x05\x03\x0c\x27\x00\x00\x00\x00\x00\x00\x00\x02\x00\x30\xc0\x1c\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc1\x00\x0e\x81\xc0\x1c\x00\x1c\x00\x01\x00\x36\xee\x80\x00\x10\x20\x01\x07\xfd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\xc0\x3b\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xc7\x07\x53\x2a\xc0\x4a\x00\x01\x00\x01\x00\x36\xee\x80\x00\x04\xca\x0c\x1b\x21\xc0\x4a\x00\x1c\x00\x01\x00\x36\xee\x80\x00\x10\x20\x01\x0d\xc3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x35\x00\x00\x29\x10\x00\x00\x00\x80\x00\x00\x00"

In [3]: wdns.parse_message(msg)
Out[3]: 

# DNS header
(64443,     # id
 33808,     # flags

# QUESTION
 ('\x00', 1, 2),    # . IN NS

# ANSWER SECTION
 [('\x00',          # first answer RRset: .
   1,               # IN
   2,               # NS
   518400L,         # TTL
   ['\x01K\x0cROOT-SERVERS\x03NET\x00',     # list of rdata values for this RRset
    '\x01L\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01M\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01A\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01B\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01C\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01D\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01E\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01F\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01G\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01H\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01I\x0cROOT-SERVERS\x03NET\x00',     #
    '\x01J\x0cROOT-SERVERS\x03NET\x00'])],  # rdata list end, RRset end, section end

# AUTHORITY SECTION (empty)
 [],

# ADDITIONAL SECTION

# A.ROOT-SERVERS.NET. IN A 3600000 198.41.0.4
 [('\x01A\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc6)\x00\x04']),

# A.ROOT-SERVERS.NET. IN A 3600000 2001:503:ba3e::2:30
  ('\x01A\x0cROOT-SERVERS\x03NET\x00',
   1,
   28,
   3600000L,
   [' \x01\x05\x03\xba>\x00\x00\x00\x00\x00\x00\x00\x02\x000']),

# B.ROOT-SERVERS.NET. IN A 3600000 192.228.79.201
  ('\x01B\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc0\xe4O\xc9']),

# C.ROOT-SERVERS.NET. IN A 3600000 192.33.4.12
  ('\x01C\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc0!\x04\x0c']),

# D.ROOT-SERVERS.NET. IN A 3600000 128.8.10.90
  ('\x01D\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\x80\x08\nZ']),

# E.ROOT-SERVERS.NET. IN A 3600000 192.203.230.10
  ('\x01E\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc0\xcb\xe6\n']),

# F.ROOT-SERVERS.NET. IN A 3600000 192.5.5.241
  ('\x01F\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc0\x05\x05\xf1']),

# F.ROOT-SERVERS.NET. IN AAAA 3600000 2001:500:2f::f
  ('\x01F\x0cROOT-SERVERS\x03NET\x00',
   1,
   28,
   3600000L,
   [' \x01\x05\x00\x00/\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f']),

# G.ROOT-SERVERS.NET. IN A 3600000 192.112.36.4
  ('\x01G\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc0p$\x04']),

# H.ROOT-SERVERS.NET. IN A 3600000 128.63.2.53
  ('\x01H\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\x80?\x025']),

# H.ROOT-SERVERS.NET. IN AAAA 3600000 2001:500:1::803f:235
  ('\x01H\x0cROOT-SERVERS\x03NET\x00',
   1,
   28,
   3600000L,
   [' \x01\x05\x00\x00\x01\x00\x00\x00\x00\x00\x00\x80?\x025']),

# I.ROOT-SERVERS.NET. IN A 3600000 192.36.148.17
  ('\x01I\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc0$\x94\x11']),

# J.ROOT-SERVERS.NET. IN A 3600000 192.58.128.30
  ('\x01J\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc0:\x80\x1e']),

# J.ROOT-SERVERS.NET. IN AAAA 3600000 2001:503:c27::2:30
  ('\x01J\x0cROOT-SERVERS\x03NET\x00',
   1,
   28,
   3600000L,
   [" \x01\x05\x03\x0c'\x00\x00\x00\x00\x00\x00\x00\x02\x000"]),

# K.ROOT-SERVERS.NET. IN A 3600000 193.0.14.129
  ('\x01K\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc1\x00\x0e\x81']),

# K.ROOT-SERVERS.NET. IN AAAA 3600000 2001:7fd::1
  ('\x01K\x0cROOT-SERVERS\x03NET\x00',
   1,
   28,
   3600000L,
   [' \x01\x07\xfd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01']),

# L.ROOT-SERVERS.NET. IN A 3600000 199.7.83.42
  ('\x01L\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xc7\x07S*']),

# M.ROOT-SERVERS.NET. IN A 3600000 202.12.27.33
  ('\x01M\x0cROOT-SERVERS\x03NET\x00', 1, 1, 3600000L, ['\xca\x0c\x1b!']),

# M.ROOT-SERVERS.NET. IN AAAA 3600000 2001:dc3::35
  ('\x01M\x0cROOT-SERVERS\x03NET\x00',
   1,
   28,
   3600000L,
   [' \x01\r\xc3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x005']),

# OPT pseudo-record: ., 4K buffer size, EDNS flags 32768 (0x8000) (DO set), 0-length rdata
  ('\x00', 4096, 41, 32768L, [''])]) # end of additional section, end of result tuple
